
$computername


if($Name.Length -gt 10)


I'd had a lenght verification also to prevent a fail since I belive the name can't be longer than 15 characters. Not sure of the syntaxe here but something like:

if($hostname.lenght -gt 15){

$hostname = $hostname.substring(15,$hostname.lenght-15)

}


https://social.technet.microsoft.com/wiki/contents/articles/4546.working-with-passwords-secure-strings-and-credentials-in-windows-powershell.aspx



working cred: https://www.memosforadmins.com/post/securepasswordwithpowershell/
pt 2 https://www.pdq.com/blog/secure-password-with-powershell-encrypting-credentials-part-2/